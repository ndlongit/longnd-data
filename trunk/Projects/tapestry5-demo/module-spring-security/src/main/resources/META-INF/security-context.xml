<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
						http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
						http://www.springframework.org/schema/security
						http://www.springframework.org/schema/security/spring-security-3.1.xsd">

	<http auto-config='true'>
		<intercept-url pattern="/css/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />

		<intercept-url pattern="/login" access="IS_AUTHENTICATED_ANONYMOUSLY" />

		<intercept-url pattern="/**" access="ROLE_USER, ROLE_ADMIN" />

		<form-login login-page='/login' default-target-url="/login-success"
			authentication-failure-url="/login-fail" />
		<access-denied-handler error-page="/access-denied" />
		<logout logout-success-url="/logout" />
	</http>

	<!-- <http auto-config="true"> -->
	<!-- <intercept-url pattern="/home" access="ROLE_ADMIN,ROLE_MANAGER" /> -->
	<!-- <form-login login-processing-url="/authenticate" -->
	<!-- username-parameter="username" password-parameter="password" -->
	<!-- login-page="/login" default-target-url="/home" -->
	<!-- authentication-failure-url="/loginfailed" /> -->
	<!-- <logout logout-success-url="/logout" /> -->
	<!-- <access-denied-handler error-page="/accessDenied" /> -->
	<!-- </http> -->

	<!-- Custom Password Encoder -->
<!-- 	<beans:bean id="encryptor" class="org.java.demo.util.spring.PasswordEncryptor" /> -->

	<authentication-manager>
	
		<!--  	All passwords are "123456" -->	
				
		<!-- Using MD5 - Not working at now-->
<!-- 		<authentication-provider> -->
<!-- 			<password-encoder ref="encryptor" /> -->
<!-- 			<user-service> -->
<!-- 				<user name="admin1" password="e10adc3949ba59abbe56e057f20f883e" -->
<!-- 					authorities="ROLE_ADMIN" /> -->
<!-- 				<user name="user1" password="e10adc3949ba59abbe56e057f20f883e" -->
<!-- 					authorities="ROLE_USER" /> -->
<!-- 				<user name="student1" password="e10adc3949ba59abbe56e057f20f883e" -->
<!-- 					authorities="ROLE_STUDENT" /> -->
<!-- 			</user-service> -->
<!-- 		</authentication-provider> -->
		
<!-- Using SHA -->
		<authentication-provider>
				<password-encoder hash="sha" />
				<user-service>
					<user name="admin1" password="7c4a8d09ca3762af61e59520943dc26494f8941b"
						authorities="ROLE_ADMIN" />
					<user name="user1" password="7c4a8d09ca3762af61e59520943dc26494f8941b"
						authorities="ROLE_USER, ROLE_STUDENT" />
				</user-service>
		</authentication-provider>
	</authentication-manager>

</beans:beans>
